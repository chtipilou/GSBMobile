{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar BASE_URL = 'https://s5-4242.nuage-peda.fr/gsbvttMobile/API';\nexport var login = function () {\n  var _ref = _asyncToGenerator(function* (email, password) {\n    try {\n      var response = yield fetch(`${BASE_URL}/ApiAuth.php`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          email: email,\n          password: password\n        })\n      });\n      var data = yield response.json();\n      if (!response.ok) {\n        throw new Error(data.message || 'Erreur de connexion');\n      }\n      return data;\n    } catch (error) {\n      console.error('Login error:', error);\n      throw error;\n    }\n  });\n  return function login(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar fetchWithAuth = function () {\n  var _ref2 = _asyncToGenerator(function* (endpoint) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    try {\n      var token = yield AsyncStorage.getItem('userToken');\n      if (!token) {\n        throw new Error('Token non trouvé');\n      }\n      var response = yield fetch(`${BASE_URL}${endpoint}`, _objectSpread(_objectSpread({}, options), {}, {\n        headers: _objectSpread(_objectSpread({}, options.headers), {}, {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        })\n      }));\n      var data = yield response.json();\n      if (!response.ok) {\n        throw new Error(data.message || 'Erreur API');\n      }\n      return data;\n    } catch (error) {\n      console.error('API error:', error);\n      throw error;\n    }\n  });\n  return function fetchWithAuth(_x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var fetchVisites = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    return fetchWithAuth('/ApiVisite.php');\n  });\n  return function fetchVisites() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var createVisite = function () {\n  var _ref4 = _asyncToGenerator(function* (visiteData) {\n    return fetchWithAuth('/ApiVisite.php', {\n      method: 'POST',\n      body: JSON.stringify(visiteData)\n    });\n  });\n  return function createVisite(_x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var fetchCabinets = function () {\n  var _ref5 = _asyncToGenerator(function* (latitude, longitude) {\n    var params = latitude && longitude ? `?latitude=${latitude}&longitude=${longitude}` : '';\n    return fetchWithAuth(`/ApiCabinet.php${params}`);\n  });\n  return function fetchCabinets(_x5, _x6) {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var fetchMedecins = function () {\n  var _ref6 = _asyncToGenerator(function* () {\n    return fetchWithAuth('/ApiMedecin.php');\n  });\n  return function fetchMedecins() {\n    return _ref6.apply(this, arguments);\n  };\n}();\nexport var getVisite = function () {\n  var _ref7 = _asyncToGenerator(function* (id) {\n    return fetchWithAuth(`/ApiVisite.php?id=${id}`);\n  });\n  return function getVisite(_x7) {\n    return _ref7.apply(this, arguments);\n  };\n}();\nexport var updateVisite = function () {\n  var _ref8 = _asyncToGenerator(function* (visiteData) {\n    return fetchWithAuth('/ApiVisite.php', {\n      method: 'PUT',\n      body: JSON.stringify(visiteData)\n    });\n  });\n  return function updateVisite(_x8) {\n    return _ref8.apply(this, arguments);\n  };\n}();\nexport var deleteVisite = function () {\n  var _ref9 = _asyncToGenerator(function* (id) {\n    return fetchWithAuth(`/ApiVisite.php?id=${id}`, {\n      method: 'DELETE'\n    });\n  });\n  return function deleteVisite(_x9) {\n    return _ref9.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["AsyncStorage","BASE_URL","login","_ref","_asyncToGenerator","email","password","response","fetch","method","headers","body","JSON","stringify","data","json","ok","Error","message","error","console","_x","_x2","apply","arguments","fetchWithAuth","_ref2","endpoint","options","length","undefined","token","getItem","_objectSpread","_x3","fetchVisites","_ref3","createVisite","_ref4","visiteData","_x4","fetchCabinets","_ref5","latitude","longitude","params","_x5","_x6","fetchMedecins","_ref6","getVisite","_ref7","id","_x7","updateVisite","_ref8","_x8","deleteVisite","_ref9","_x9"],"sources":["D:/BTS/AP/GSBVTTMobile/src/services/api.ts"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst BASE_URL = 'https://s5-4242.nuage-peda.fr/gsbvttMobile/API';\r\n\r\ninterface LoginResponse {\r\n  status: string;\r\n  message: string;\r\n  user: {\r\n    id: number;\r\n    nom: string;\r\n    prenom: string;\r\n    email: string;\r\n  };\r\n  token: string;\r\n}\r\n\r\ninterface ApiError {\r\n  error: string;\r\n  message?: string;\r\n}\r\n\r\nexport const login = async (email: string, password: string): Promise<LoginResponse> => {\r\n  try {\r\n    const response = await fetch(`${BASE_URL}/ApiAuth.php`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    const data = await response.json();\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(data.message || 'Erreur de connexion');\r\n    }\r\n\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst fetchWithAuth = async (endpoint: string, options: RequestInit = {}) => {\r\n  try {\r\n    const token = await AsyncStorage.getItem('userToken');\r\n    \r\n    if (!token) {\r\n      throw new Error('Token non trouvé');\r\n    }\r\n\r\n    const response = await fetch(`${BASE_URL}${endpoint}`, {\r\n      ...options,\r\n      headers: {\r\n        ...options.headers,\r\n        'Authorization': `Bearer ${token}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    const data = await response.json();\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(data.message || 'Erreur API');\r\n    }\r\n\r\n    return data;\r\n  } catch (error) {\r\n    console.error('API error:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const fetchVisites = async () => {\r\n  return fetchWithAuth('/ApiVisite.php');\r\n};\r\n\r\nexport const createVisite = async (visiteData: any) => {\r\n  return fetchWithAuth('/ApiVisite.php', {\r\n    method: 'POST',\r\n    body: JSON.stringify(visiteData),\r\n  });\r\n};\r\n\r\nexport const fetchCabinets = async (latitude?: number, longitude?: number) => {\r\n  const params = latitude && longitude ? `?latitude=${latitude}&longitude=${longitude}` : '';\r\n  return fetchWithAuth(`/ApiCabinet.php${params}`);\r\n};\r\n\r\nexport const fetchMedecins = async () => {\r\n  return fetchWithAuth('/ApiMedecin.php');\r\n};\r\n\r\nexport const getVisite = async (id: number) => {\r\n  return fetchWithAuth(`/ApiVisite.php?id=${id}`);\r\n};\r\n\r\nexport const updateVisite = async (visiteData: {\r\n  id_visite: number;\r\n  id_visiteur: number;\r\n  id_medecin: number;\r\n  date_visite: string;\r\n  heure_arrivee: string;\r\n  heure_debut_entretien: string;\r\n  heure_depart: string;\r\n  rendez_vous: boolean;\r\n}) => {\r\n  return fetchWithAuth('/ApiVisite.php', {\r\n    method: 'PUT',\r\n    body: JSON.stringify(visiteData)\r\n  });\r\n};\r\n\r\nexport const deleteVisite = async (id: number) => {\r\n  return fetchWithAuth(`/ApiVisite.php?id=${id}`, {\r\n    method: 'DELETE'\r\n  });\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}