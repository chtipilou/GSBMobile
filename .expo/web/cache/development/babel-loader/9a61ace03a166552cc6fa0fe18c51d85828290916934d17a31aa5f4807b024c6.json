{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nvar BASE_URL = 'https://s5-4242.nuage-peda.fr/gsbvttMobile/API';\nvar fetchWithAuth = function () {\n  var _ref = _asyncToGenerator(function* (endpoint) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var token = yield AsyncStorage.getItem('userToken');\n    var headers = _objectSpread(_objectSpread({}, options.headers), {}, {\n      'Authorization': `Bearer ${token}`,\n      'Content-Type': 'application/json'\n    });\n    var response = yield fetch(`${BASE_URL}${endpoint}`, _objectSpread(_objectSpread({}, options), {}, {\n      headers: headers\n    }));\n    if (!response.ok) {\n      throw new Error(`API Error: ${response.status}`);\n    }\n    return response.json();\n  });\n  return function fetchWithAuth(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var login = function () {\n  var _ref2 = _asyncToGenerator(function* (email, password) {\n    var response = yield fetch(`${BASE_URL}/ApiAuth.php`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        email: email,\n        password: password\n      })\n    });\n    if (!response.ok) {\n      throw new Error('Erreur de connexion');\n    }\n    return response.json();\n  });\n  return function login(_x2, _x3) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var fetchVisites = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    return fetchWithAuth('/ApiVisite.php');\n  });\n  return function fetchVisites() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var fetchCabinets = function () {\n  var _ref4 = _asyncToGenerator(function* (latitude, longitude) {\n    var params = latitude && longitude ? `?latitude=${latitude}&longitude=${longitude}` : '';\n    return fetchWithAuth(`/ApiCabinet.php${params}`);\n  });\n  return function fetchCabinets(_x4, _x5) {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var fetchMedecins = function () {\n  var _ref5 = _asyncToGenerator(function* () {\n    return fetchWithAuth('/ApiMedecin.php');\n  });\n  return function fetchMedecins() {\n    return _ref5.apply(this, arguments);\n  };\n}();\nexport var createVisite = function () {\n  var _ref6 = _asyncToGenerator(function* (visiteData) {\n    return fetchWithAuth('/ApiVisite.php', {\n      method: 'POST',\n      body: JSON.stringify(visiteData)\n    });\n  });\n  return function createVisite(_x6) {\n    return _ref6.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["BASE_URL","fetchWithAuth","_ref","_asyncToGenerator","endpoint","options","arguments","length","undefined","token","AsyncStorage","getItem","headers","_objectSpread","response","fetch","ok","Error","status","json","_x","apply","login","_ref2","email","password","method","body","JSON","stringify","_x2","_x3","fetchVisites","_ref3","fetchCabinets","_ref4","latitude","longitude","params","_x4","_x5","fetchMedecins","_ref5","createVisite","_ref6","visiteData","_x6"],"sources":["D:/BTS/AP/GSBVTTMobile/src/services/api.ts"],"sourcesContent":["const BASE_URL = 'https://s5-4242.nuage-peda.fr/gsbvttMobile/API';\r\n\r\ninterface LoginResponse {\r\n  status: string;\r\n  message: string;\r\n  user: {\r\n    id: number;\r\n    nom: string;\r\n    prenom: string;\r\n    email: string;\r\n  };\r\n  token: string;\r\n}\r\n\r\nconst fetchWithAuth = async (endpoint: string, options: RequestInit = {}) => {\r\n  const token = await AsyncStorage.getItem('userToken');\r\n  const headers = {\r\n    ...options.headers,\r\n    'Authorization': `Bearer ${token}`,\r\n    'Content-Type': 'application/json',\r\n  };\r\n\r\n  const response = await fetch(`${BASE_URL}${endpoint}`, {\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(`API Error: ${response.status}`);\r\n  }\r\n\r\n  return response.json();\r\n};\r\n\r\nexport const login = async (email: string, password: string): Promise<LoginResponse> => {\r\n  const response = await fetch(`${BASE_URL}/ApiAuth.php`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ email, password }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Erreur de connexion');\r\n  }\r\n\r\n  return response.json();\r\n};\r\n\r\nexport const fetchVisites = async () => {\r\n  return fetchWithAuth('/ApiVisite.php');\r\n};\r\n\r\nexport const fetchCabinets = async (latitude?: number, longitude?: number) => {\r\n  const params = latitude && longitude ? \r\n    `?latitude=${latitude}&longitude=${longitude}` : '';\r\n  return fetchWithAuth(`/ApiCabinet.php${params}`);\r\n};\r\n\r\nexport const fetchMedecins = async () => {\r\n  return fetchWithAuth('/ApiMedecin.php');\r\n};\r\n\r\nexport const createVisite = async (visiteData: any) => {\r\n  return fetchWithAuth('/ApiVisite.php', {\r\n    method: 'POST',\r\n    body: JSON.stringify(visiteData),\r\n  });\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}